# 个人工作台产品方案

本文档描述系统「个人工作台」的产品方案，工作台作为一级目录，提供指令工作台和通知列表功能，并根据用户角色筛选一级目录内容。

---

## 一、概述

### 1.1 服务定位

个人工作台是系统的入口页面，为不同角色提供指令处理和通知查看功能。工作台作为一级目录，包含指令工作台和通知列表两个二级目录。

### 1.2 目录结构

- **一级目录**：工作台
- **二级目录**：
  - 指令工作台（根据当前登录人员的角色决定有哪些三级目录）
  - 通知列表

---

## 二、一级目录内容筛选规则

根据当前登录用户的角色，系统自动筛选显示的一级目录内容：

### 2.1 超级管理员

- **显示所有一级目录**：
  - 合同宝
  - 指令宝
  - 匹配宝
  - 交易宝
  - 风控宝
  - 报表
  - 全局设置

### 2.2 交易员

- **显示一级目录**：
  - 交易宝

### 2.3 风控员

- **显示一级目录**：
  - 风控宝
  - 报表（其他报表）

### 2.4 匹配员

- **显示一级目录**：
  - 匹配宝

### 2.5 制单员

- **显示一级目录**：
  - 合同宝

### 2.6 指令员

- **显示一级目录**：
  - 指令宝

### 2.7 业务经理

- **显示一级目录**：
  - 合同宝（仅显示合同中业务经理是当前用户的合同）

### 2.8 角色权限说明

- 用户可能拥有多个角色，系统取并集显示所有角色对应的一级目录
- 数据权限按角色和数据范围过滤（如业务经理只看自己负责的合同）
- 一级目录的显示/隐藏由后端根据用户角色动态返回

---

## 三、指令工作台

### 3.1 目录路径

- 一级：工作台
- 二级：指令工作台
- 三级：根据当前登录人员的角色决定

### 3.2 三级目录列表

根据当前登录用户的角色，系统显示对应的指令工作台三级目录：

#### 3.2.1 业务经理工作台

- **显示条件**：用户拥有"业务经理"角色
- **功能说明**：业务经理可以发起指令、查看自己发起的指令、查看与自己相关的指令
- **详细功能**：参考指令宝模块中"业务经理指令发起"相关文档

#### 3.2.2 交易员工作台

- **显示条件**：用户拥有"交易员"角色
- **功能说明**：交易员可以发起交易指令、认领交易指令、查看所有交易指令
- **详细功能**：参考指令宝模块中"交易员指令发起"相关文档

#### 3.2.3 指令员工作台

- **显示条件**：用户拥有"指令员"角色
- **功能说明**：指令员可以发起指令、查看所有指令（包括均价指令自动发起、变更、新增导致的指令变化）
- **详细功能**：参考指令宝模块中"指令员指令发起"相关文档

#### 3.2.4 制单员工作台

- **显示条件**：用户拥有"制单员"角色
- **功能说明**：制单员可以查看需要制单的指令、完成合同创建
- **详细功能**：参考指令宝模块中"制单员创建合同"相关文档

#### 3.2.5 客商工作台

- **显示条件**：用户拥有"客商"角色
- **功能说明**：客商可以发起期货交易指令、查看自己发起的指令
- **详细功能**：参考指令宝模块中"客商指令权限设置"相关文档

### 3.3 三级目录显示规则

- 系统根据当前登录用户的角色，动态显示对应的三级目录
- 如果用户拥有多个角色，则显示多个对应的三级目录
- 三级目录的显示/隐藏由后端根据用户角色动态返回
- 点击三级目录进入对应的指令工作台页面

### 3.4 数据权限

- 指令工作台中的数据按用户角色和数据权限过滤
- 业务经理：只看自己发起的指令和与自己相关的指令
- 交易员：可以查看所有交易指令，但只能认领自己有权限的指令
- 指令员：可以查看所有指令
- 制单员：只看需要制单的指令
- 客商：只看自己发起的指令

---

## 四、通知列表

### 4.1 目录路径

- 一级：工作台
- 二级：通知列表

### 4.2 功能说明

通知列表统一展示所有由"风控设置"中配置的异常提醒规则触发生成的告警记录，以及被转发的通知记录。

### 4.3 数据来源

#### 4.3.1 告警转通知

- 来源于风控宝告警记录中被"转通知"的记录
- 当告警记录被"转通知"后，会在被通知人员的工作台"通知列表"中生成一条通知记录
- 通知记录与告警记录关联，但展示方式更简洁（适合工作台快速查看）

#### 4.3.2 系统通知

- 系统公告
- 任务分派
- 其他系统级通知

### 4.4 列表字段

- 通知时间
- 通知编号（系统自动生成）
- 通知类型（告警转通知 / 系统通知）
- 通知标题
- 通知内容（简要）
- 来源（如：风控告警、系统公告）
- 处理状态（未处理 / 已处理 / 关注中）
- 处理人
- 最近处理时间
- 备注（显示最近几条处理记录摘要）

### 4.5 筛选条件

- **时间范围**：支持按通知时间区间筛选（近 1 日/近 7 日/近 30 日/自定义）
- **通知类型**：多选（告警转通知 / 系统通知）
- **处理状态**：未处理 / 已处理 / 关注中
- **来源**：风控告警、系统公告等

### 4.6 处理操作

#### 4.6.1 支持的处理动作

**【关注】**
- 表示该通知需要持续关注，暂不关闭
- 操作后状态变为"关注中"
- 操作会记录到告警记录的备注中，格式如：张三 关注

**【已处理】**
- 表示已确认并完成相应业务/风控动作
- 操作后状态变为"已处理"
- 操作会记录到告警记录的备注中，格式如：张三 已处理

**【转通知】**
- 将该通知信息转发给某一或多位用户
- 转发后，被转发的用户在其工作台的"通知列表"中可以看到该通知
- 操作会记录到告警记录的备注中，格式如：张三 转通知 李四

**批量处理**：支持批量处理，多选后点按钮操作

#### 4.6.2 与风控告警记录的联动

- 在通知列表界面点击"关注/已处理/转通知"，操作会记录到告警记录的备注中
- 两个界面的操作状态保持同步
- 从通知列表可以跳转到"风控告警记录"的详情页查看完整信息

### 4.7 红点提醒

- 记录上一次页面打开，显示到哪一条通知记录
- 之后有新来的通知记录，会在二级目录上显示一个红点
- 点开通知列表，会在上次之后的条目上显示new
- 以此反复，这个记录应该记在期现服务器上的
- 参考风控宝6.10章节的红点提醒规则

---

## 五、手机分辨率适配

### 5.1 设备判断

- 系统只判断一个分辨率界限来区分设备类型（参考0_系统缺省默认.md）
- 大于等于该界限：使用PC端布局
- 小于该界限：使用移动端布局

### 5.2 手机端一级目录显示

- **手机分辨率登录时，只提供以下一级目录**：
  - 工作台（包含指令工作台和通知列表）
  - 交易宝（需要做一个手机分辨率适配的交易宝）

### 5.3 手机端工作台内容

- **指令工作台**：根据用户角色显示对应的三级目录
- **通知列表**：完整功能，支持查看和处理通知

### 5.4 手机端交易宝适配

- **需要做一个手机分辨率适配的交易宝**
- 功能要求：
  - 支持查看行情
  - 支持下单操作
  - 支持查看持仓
  - 支持查看账户信息
  - 界面布局适配手机屏幕
  - 操作流程简化，适合移动端使用

### 5.5 手机端界面布局

- 采用移动端友好的布局方式
- 列表采用卡片式展示
- 操作按钮采用底部固定或悬浮按钮
- 支持下拉刷新
- 支持上拉加载更多

---

## 六、数据来源和权限

### 6.1 数据来源

#### 6.1.1 指令数据

- **数据来源**：指令表、指令匹配记录、指令认领记录
- **权限过滤**：按用户角色和数据权限过滤
- **状态计算**：与指令宝模块保持一致

#### 6.1.2 通知数据

- **数据来源**：风控告警记录（被转通知的记录）、系统通知表
- **权限过滤**：只显示当前用户被转发的通知或系统通知
- **状态同步**：与风控告警记录保持状态同步

### 6.2 权限控制

#### 6.2.1 一级目录权限

- 一级目录的显示/隐藏由后端根据用户角色动态返回
- 用户只能看到自己有权限访问的一级目录

#### 6.2.2 指令工作台权限

- 三级目录的显示/隐藏由后端根据用户角色动态返回
- 指令数据的查看权限按用户角色和数据范围过滤
- 指令操作权限（创建、认领、撤回等）按指令权限设置控制

#### 6.2.3 通知列表权限

- 只显示当前用户被转发的通知或系统通知
- 通知处理操作权限按用户角色控制

---

## 七、界面状态保存

### 7.1 保存内容

- 用户当前打开的页面（Tab页签状态）
- 页面布局配置（如：列显示/隐藏、列宽、排序、筛选条件等）
- 左侧菜单的折叠/展开状态
- 通知列表的查看位置（用于红点提醒）

### 7.2 保存方式

- 将用户当前页面和布局信息传到期现服务端进行记录
- 按用户ID（hedge_user）和设备类型分别存储

### 7.3 设备类型区分

- PC端和移动端（手机）的界面状态需要分开存储
- 用户在不同设备上登录时，会加载对应设备的界面状态
- 例如：用户在PC上打开的Tab和布局，不会影响手机端的界面状态

### 7.4 异地登录恢复

- 用户在不同地点登录时，系统会加载该用户在该设备类型下保存的界面状态
- 确保用户无论在哪里登录，都能看到上次使用时的界面布局

---

## 八、其他补充

### 8.1 角色与权限管理

- 角色定义在全局设置-人员管理-人员角色管理中配置
- 用户角色分配在人员管理中配置
- 指令权限设置在指令宝-指令权限设置中配置

### 8.2 数据一致性

- 指令工作台的数据与指令宝模块保持一致
- 通知列表的数据与风控告警记录保持一致
- 数据更新采用实时或准实时同步

### 8.3 性能优化

- 指令工作台列表支持分页加载
- 通知列表支持分页加载
- 支持数据缓存，减少服务器压力
- 手机端优化加载速度，减少数据量

### 8.4 审计要求

- 所有通知处理操作需留痕
- 包括操作人、时间、处理动作（关注/已处理/转通知）、备注
- 支持按时间/处理人/对象查询历史处理情况

---

## 九、版本历史

### V1.0（2024-01-XX）

**初始版本**

- ✅ 完成个人工作台的整体架构设计
- ✅ 明确一级目录内容筛选规则
- ✅ 明确指令工作台的三级目录结构
- ✅ 明确通知列表功能
- ✅ 明确手机分辨率适配要求
- ✅ 明确权限控制和数据来源

**主要功能**：
1. 工作台作为一级目录
2. 二级目录：指令工作台、通知列表
3. 根据角色筛选一级目录内容
4. 指令工作台根据角色显示三级目录
5. 通知列表统一展示告警转通知和系统通知
6. 手机分辨率适配：只提供指令工作台、通知列表、交易宝

**文档状态**：✅ 已定稿，可用于开发实施

---

## 附录：参考信息

### 相关文档

- 0_系统缺省默认.md：设备响应式布局判断、界面状态保存
- 0_全局设置.md：角色与权限管理
- 3_指令宝.md：指令权限设置、各岗位工作台的指令界面
- 7_风控宝.md：风控告警记录、红点提醒规则

### 相关概念

- **指令工作台**：根据不同角色提供对应的指令处理界面
- **通知列表**：统一展示告警转通知和系统通知
- **角色权限**：根据用户角色控制一级目录和数据的访问权限
- **手机分辨率适配**：针对手机设备的界面和功能适配

---

本方案作为系统个人工作台的完整产品说明，开发人员应严格按照本方案实现功能，确保权限控制的准确性和数据的一致性。