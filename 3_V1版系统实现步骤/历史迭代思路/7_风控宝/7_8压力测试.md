目录路径：
    一级：风控宝
    二级：压力测试

服务定位
    极端风险测试
        通过压力测试，评估在极端市场情景下的潜在损失，补充VaR在极端情况下的不足。
    多场景分析
        支持多种压力测试场景，包括历史极端日、跨市场联动、基差骤变、汇率冲击等。
    支持多维度分析
        支持按保值方案维度或期货账户维度分别测试，反映不同层面的极端风险。

一、整体布局

    顶部筛选区
        维度筛选
            保值方案（多选）
            现货品种、品牌（多选）
            期货账户（多选）
        维度选择器（重要）
            保值方案维度
                基于期现关联关系的逻辑持仓
                测试业务逻辑层面的极端风险
                用于业务风控，关注套保效果在极端情况下的表现
            期货账户维度
                基于实际开平仓结果的物理持仓
                测试实际持仓层面的极端风险
                用于资金风控，关注实际持仓在极端情况下的损失
        时间维度
            测试基准日（当前日/选定交易日）
            历史数据窗口长度（用于历史极端日场景）

    场景配置区
        场景类型选择
            历史极端日
                重现历史极端行情
                从历史数据中识别极端波动日
                应用极端日的价格变化到当前持仓
                注意：需要明确使用哪种连续合约类型的历史数据
            跨市场联动
                模拟多个市场同时发生极端波动
                考虑不同市场之间的相关性
                适用于多品种、多市场的组合持仓
            基差骤变
                模拟基差异常变化的情况
                基差 = 现货价格 - 期货价格
                注意：基差计算依赖期货价格，需要明确连续合约类型
            汇率冲击
                模拟汇率大幅波动的情况
                适用于涉及外汇的跨市场交易
            自定义场景
                用户可以自定义价格冲击幅度
                可以组合多个因素（价格、基差、汇率等）
        场景参数设置
            历史极端日场景
                极端日识别标准（如：涨跌幅超过N%）
                历史数据窗口长度
                期货价格连续合约类型选择（主连/近月连续/指数连续）
            跨市场联动场景
                联动市场选择
                价格冲击幅度（各市场的涨跌幅）
                相关性参数
            基差骤变场景
                基差变化幅度（如：基差扩大/缩小N元）
                期货价格连续合约类型选择（主连/近月连续/指数连续）
                历史基差数据窗口
            汇率冲击场景
                汇率变化幅度（如：汇率升值/贬值N%）
                涉及的外汇品种
        期货价格连续合约类型选择（重要）
            主连（主力连续）
                使用主力合约拼接的历史价格序列
                适用于大多数压力测试场景
                反映主力合约的价格走势
            近月连续
                使用近月合约拼接的历史价格序列
                适用于关注近月合约的场景
                反映近月合约的价格走势
            指数连续
                使用指数合约的历史价格序列
                适用于需要平滑价格波动的场景
                反映整体品种的价格走势
        注意：不同的连续合约类型会影响历史价格数据，进而影响压力测试结果

    核心结果展示区
        损失区间卡片
            显示最坏情景下的损失区间（最小损失 ~ 最大损失）
            显示各场景下的潜在损失
            当前测试场景名称
            风险等级标识（红/黄/绿）
        场景对比卡片
            多场景损失对比
            最坏情景损失
            风险等级评估

    分析图表区
        损失分布图
            展示各场景下的损失分布
            柱状图或箱线图展示损失区间
            标注最坏情景损失
        场景对比图
            多场景损失对比柱状图
            横向对比不同场景下的损失
            帮助识别最危险的场景
        历史极端日回放图
            展示历史极端日的价格走势
            标注极端波动的时间点
            帮助理解极端日的特征

    明细数据区
        持仓明细表
            展示参与压力测试的持仓明细
            字段包括：
                保值方案/期货账户（根据选择的维度）
                品种
                品牌（保值方案维度）
                合约代码
                持仓方向（买入/卖出 或 多头/空头）
                持仓数量（手数）
                当前价格
                场景价格（极端情景下的价格）
                价格变化幅度
                损失金额
                敞口系数（保值方案维度）
        支持排序、筛选、导出

二、交互功能

    测试触发
        手动测试：点击"执行压力测试"按钮，根据当前筛选条件和场景配置进行测试
        批量测试：支持同时执行多个场景的测试，对比结果
        参数变更时提示：修改场景参数后提示需要重新测试

    维度切换
        在保值方案维度和期货账户维度之间切换
        切换时自动重新执行测试
        保留各自的筛选条件和场景配置

    场景管理
        场景保存：支持保存自定义场景配置，方便后续使用
        场景模板：提供常用场景模板，快速选择
        场景对比：支持同时执行多个场景，对比结果

    下钻功能
        从公司整体 → 保值方案/期货账户 → 品种 → 品牌/月份 → 合约明细
        点击图表元素（如柱状图的柱子）进入下钻视图
        支持返回上一级视图

    参数调整
        实时预览：调整场景参数后显示参数变更提示，需要重新测试
        参数对比：支持保存多组场景配置，对比不同场景下的损失
        参数历史：记录场景参数变更历史，支持回退到历史配置

    导出功能
        导出压力测试报告（Excel/PDF）
            包含损失区间、场景配置、分析图表、明细数据
        导出明细数据（Excel/CSV）
            导出参与测试的持仓明细和损失明细

    刷新功能
        手动刷新：点击刷新按钮更新最新数据
        自动刷新：可设置自动刷新间隔（如每5分钟）

三、数据来源

    持仓数据
        保值方案维度
            数据来源：期现关联记录（期现备注表）+ 期货委托/成交记录（按保值方案归属）
            计算方式：按保值方案、合约、买卖方向进行对冲计算
            关键字段：保值方案_id、合约代码、买卖方向、关联手数、敞口系数
        期货账户维度
            数据来源：交易所实际持仓数据（来自交易宝/快期行情服务）
            计算方式：基于实际开平仓结果，按期货账户、合约、方向统计
            关键字段：期货账户_id、合约代码、持仓方向、持仓手数、开仓均价、最新价

    价格数据
        期货价格历史数据
            数据来源：快期行情服务、历史行情数据库
            连续合约类型：主连/近月连续/指数连续（在场景配置中选择）
            历史数据窗口：根据配置的窗口长度获取
            用于历史极端日场景识别
        现货价格历史数据
            数据来源：现货价格历史数据（按品种/品牌）
            用于计算基差历史数据
        实时行情
            期货实时价格：用于当前持仓估值
            现货实时价格：用于计算当前敞口

    市场数据
        历史极端行情数据
            用于"历史极端日"场景
            注意：需要明确使用哪种连续合约类型的历史数据
        跨市场相关性数据
            用于"跨市场联动"场景
            不同市场之间的价格相关性
        汇率数据
            用于"汇率冲击"场景
            历史汇率数据和实时汇率
        基差历史波动数据
            用于"基差骤变"场景
            注意：基差计算依赖期货价格，需要明确连续合约类型

    配置数据
        保值方案配置
        期货账户配置
        现货品种与品牌配置
        敞口系数配置（品牌 × 期货合约的敞口系数）

四、场景说明

    历史极端日场景
        原理：从历史数据中识别极端波动日，将极端日的价格变化应用到当前持仓
        步骤：
            1. 根据选择的连续合约类型，获取历史价格数据
            2. 计算历史日收益率
            3. 识别极端波动日（如：涨跌幅超过N%）
            4. 将极端日的价格变化应用到当前持仓，计算损失
        适用场景：评估历史极端行情重现时的风险
        注意事项：不同的连续合约类型会导致不同的极端日识别结果

    跨市场联动场景
        原理：模拟多个市场同时发生极端波动，考虑市场间的相关性
        步骤：
            1. 选择联动市场（如：铜、铝、锌同时波动）
            2. 设置各市场的价格冲击幅度
            3. 考虑市场间的相关性（如：相关性系数）
            4. 计算组合持仓的损失
        适用场景：多品种、多市场的组合持仓
        注意事项：需要准确估计市场间的相关性

    基差骤变场景
        原理：模拟基差异常变化的情况，基差 = 现货价格 - 期货价格
        步骤：
            1. 根据选择的连续合约类型，计算历史基差
            2. 识别基差异常变化的情况（如：基差扩大/缩小N元）
            3. 将基差变化应用到当前持仓，计算损失
        适用场景：评估基差异常变化对套保效果的影响
        注意事项：基差计算依赖期货价格，连续合约类型会影响基差结果

    汇率冲击场景
        原理：模拟汇率大幅波动的情况
        步骤：
            1. 识别涉及外汇的持仓
            2. 设置汇率变化幅度（如：汇率升值/贬值N%）
            3. 计算汇率变化对持仓价值的影响
        适用场景：涉及外汇的跨市场交易
        注意事项：需要准确识别涉及外汇的持仓

    自定义场景
        原理：用户可以自定义价格冲击幅度，组合多个因素
        步骤：
            1. 用户设置各品种/合约的价格冲击幅度
            2. 可以组合价格、基差、汇率等多个因素
            3. 计算自定义场景下的损失
        适用场景：针对特定风险点的定制化测试
        注意事项：需要用户对市场有深入理解

五、结果解读

    损失区间含义
        例如："历史极端日场景下，损失区间为 -800万元 ~ -1200万元"
        含义：在历史极端日重现的情况下，持仓的损失可能在800万元到1200万元之间
        最坏情景损失：-1200万元（最大损失）

    风险等级判断
        绿色：损失在可承受范围内
        黄色：损失接近风险限额，需要关注
        红色：损失超过风险限额，需要采取措施降低风险

    场景对比分析
        帮助识别哪些场景下的损失最大
        可以针对性地防范高风险场景

    与VaR的对比
        VaR：在正常市场条件下的风险估计（概率意义）
        压力测试：在极端市场条件下的损失估计（情景分析）
        两者互补，共同评估风险

六、与风控设置的联动

    参数读取
        压力测试场景参数、期货价格连续合约类型等参数
        均从"风控设置"中读取（如果已配置）
        也可以在压力测试页面直接修改（仅本次测试生效，不保存到配置）

    阈值告警
        当压力测试结果（最坏情景损失）超过风控设置中配置的阈值时，触发告警
        告警记录在"风控告警记录"中
        可在风控驾驶舱中查看告警概览

    结果联动
        压力测试结果可以跳转到风控驾驶舱查看整体风险概览
        风控驾驶舱中可以显示压力测试结果卡片（简要信息），点击跳转到压力测试页面查看详情

七、权限与视图

    角色权限
        风控人员：可以查看所有维度的压力测试结果，可以修改场景参数进行测试
        交易员/业务员：可以查看自己相关保值方案/账户的压力测试结果，不能修改全局场景配置
        管理层：可以查看公司整体的压力测试结果，关注极端风险

    个性化设置（可选二开）
        不同角色可定义自己的常用场景配置和默认筛选条件
        支持保存个人场景模板
