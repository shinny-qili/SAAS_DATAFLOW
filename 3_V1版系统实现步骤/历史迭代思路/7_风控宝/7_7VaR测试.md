目录路径：
    一级：风控宝
    二级：VaR测试

服务定位
    量化风险敞口
        通过VaR（Value at Risk）方法，量化在给定置信度和时间周期下的最大可能损失。
    支持多维度分析
        支持按保值方案维度或期货账户维度分别计算，反映不同层面的风险敞口。
    历史回测验证
        通过历史回测验证VaR模型的准确度，评估模型的有效性。

一、整体布局

    顶部筛选区
        维度筛选
            保值方案（多选）
            现货品种、品牌（多选）
            期货账户（多选）
        维度选择器（重要）
            保值方案维度
                基于期现关联关系的逻辑持仓
                反映业务逻辑层面的风险敞口
                用于业务风控，关注套保效果和敞口管理
            期货账户维度
                基于实际开平仓结果的物理持仓
                反映实际持仓层面的风险敞口
                用于资金风控，关注实际持仓风险和保证金占用
        时间维度
            计算基准日（当前日/选定交易日）
            历史数据窗口长度（如250个交易日、500个交易日）
        计算方法选择
            历史模拟法
            蒙特卡洛模拟法
            参数法（方差-协方差法）

    参数配置区
        置信度设置
            95%（常用）
            99%（更保守）
            自定义（90%、97.5%等）
        时间周期设置
            1日VaR
            10日VaR
            N日VaR（自定义）
        历史数据窗口长度
            250个交易日（约1年）
            500个交易日（约2年）
            自定义窗口长度
        期货价格连续合约类型选择（重要）
            主连（主力连续）
                使用主力合约拼接的历史价格序列
                适用于大多数VaR计算场景
                反映主力合约的价格走势
            近月连续
                使用近月合约拼接的历史价格序列
                适用于关注近月合约的场景
                反映近月合约的价格走势
            指数连续
                使用指数合约的历史价格序列
                适用于需要平滑价格波动的场景
                反映整体品种的价格走势
        注意：不同的连续合约类型会影响历史价格数据，进而影响VaR计算结果

    核心结果展示区
        VaR数值卡片
            显示当前VaR数值（金额）
            置信度标识（如95%、99%）
            时间周期标识（如1日、10日）
            信号灯（红/黄/绿）表示风险等级
            与阈值的对比（如：VaR / 风险限额）
        风险等级说明
            绿色：VaR在安全范围内
            黄色：VaR接近风险限额
            红色：VaR超过风险限额

    分析图表区
        VaR趋势图
            时间序列图，展示VaR的历史变化趋势
            支持按日/按周/按月查看
            可叠加实际损失数据，进行回测对比
        VaR贡献度分析
            按保值方案拆分的VaR贡献度（保值方案维度）
            按期货账户拆分的VaR贡献度（期货账户维度）
            按品种拆分的VaR贡献度
            按品牌拆分的VaR贡献度
            饼图或柱状图展示各维度的贡献占比
        VaR分布图
            展示VaR的概率分布
            显示不同置信度下的VaR值
            帮助理解风险分布特征

    历史回测区
        回测结果统计
            回测期间内实际损失超过VaR的次数
            回测期间内实际损失超过VaR的频率
            回测准确度评估（如：95%置信度下，实际损失超过VaR的频率应接近5%）
        回测对比图
            实际损失 vs VaR预测的对比图
            标注超过VaR的异常点
            帮助评估模型的准确性

    明细数据区
        持仓明细表
            展示参与VaR计算的持仓明细
            字段包括：
                保值方案/期货账户（根据选择的维度）
                品种
                品牌（保值方案维度）
                合约代码
                持仓方向（买入/卖出 或 多头/空头）
                持仓数量（手数）
                当前价格
                敞口系数（保值方案维度）
                持仓价值
                风险贡献度
        支持排序、筛选、导出

二、交互功能

    计算触发
        手动计算：点击"计算VaR"按钮，根据当前筛选条件和参数进行计算
        自动计算：可设置定时自动计算（如每日收盘后自动计算）
        参数变更时提示：修改参数后提示需要重新计算

    维度切换
        在保值方案维度和期货账户维度之间切换
        切换时自动重新计算VaR
        保留各自的筛选条件和参数设置

    下钻功能
        从公司整体 → 保值方案/期货账户 → 品种 → 品牌/月份 → 合约明细
        点击图表元素（如饼图的扇形、柱状图的柱子）进入下钻视图
        支持返回上一级视图

    参数调整
        实时预览：调整参数后显示参数变更提示，需要重新计算
        参数对比：支持保存多组参数配置，对比不同参数下的VaR结果
        参数历史：记录参数变更历史，支持回退到历史参数配置

    导出功能
        导出VaR报告（Excel/PDF）
            包含VaR数值、参数设置、分析图表、明细数据
        导出明细数据（Excel/CSV）
            导出参与计算的持仓明细

    刷新功能
        手动刷新：点击刷新按钮更新最新数据
        自动刷新：可设置自动刷新间隔（如每5分钟）

三、数据来源

    持仓数据
        保值方案维度
            数据来源：期现关联记录（期现备注表）+ 期货委托/成交记录（按保值方案归属）
            计算方式：按保值方案、合约、买卖方向进行对冲计算
            关键字段：保值方案_id、合约代码、买卖方向、关联手数、敞口系数
        期货账户维度
            数据来源：交易所实际持仓数据（来自交易宝/快期行情服务）
            计算方式：基于实际开平仓结果，按期货账户、合约、方向统计
            关键字段：期货账户_id、合约代码、持仓方向、持仓手数、开仓均价、最新价

    价格数据
        期货价格历史数据
            数据来源：快期行情服务、历史行情数据库
            连续合约类型：主连/近月连续/指数连续（在参数配置中选择）
            历史数据窗口：根据配置的窗口长度获取
        现货价格历史数据
            数据来源：现货价格历史数据（按品种/品牌）
            用于计算基差历史数据
        实时行情
            期货实时价格：用于当前持仓估值
            现货实时价格：用于计算当前敞口

    配置数据
        保值方案配置
        期货账户配置
        现货品种与品牌配置
        敞口系数配置（品牌 × 期货合约的敞口系数）

四、计算方法说明

    历史模拟法
        原理：使用历史价格数据模拟未来价格走势
        步骤：
            1. 获取历史价格数据（根据选择的连续合约类型）
            2. 计算历史收益率序列
            3. 将历史收益率应用到当前持仓，得到模拟的盈亏分布
            4. 根据置信度，从盈亏分布中提取VaR值
        优点：不需要假设价格分布，能捕捉非正态分布特征
        缺点：依赖历史数据质量，可能无法反映未来新情况

    蒙特卡洛模拟法
        原理：通过随机模拟生成大量可能的价格路径
        步骤：
            1. 估计价格波动的统计参数（均值、方差、相关性）
            2. 生成大量随机价格路径
            3. 计算每条路径下的盈亏
            4. 根据置信度，从盈亏分布中提取VaR值
        优点：可以模拟复杂的价格动态，考虑相关性
        缺点：计算量大，需要估计准确的参数

    参数法（方差-协方差法）
        原理：假设价格变化服从正态分布，使用均值和方差估计
        步骤：
            1. 计算持仓的方差-协方差矩阵
            2. 根据置信度，从正态分布中提取分位数
            3. 计算VaR = 持仓价值 × 波动率 × 分位数
        优点：计算快速，易于理解
        缺点：假设正态分布可能不符合实际情况

五、结果解读

    VaR数值含义
        例如："95%置信度下，1日VaR = 500万元"
        含义：在95%的置信度下，未来1天内，持仓的最大可能损失不超过500万元
        注意：VaR是概率意义上的估计，不是绝对保证

    风险等级判断
        绿色：VaR在安全范围内，风险可控
        黄色：VaR接近风险限额，需要关注
        红色：VaR超过风险限额，需要采取措施降低风险

    VaR贡献度分析
        帮助识别哪些保值方案/账户/品种/品牌对总VaR的贡献最大
        可以针对性地调整高风险敞口

    历史回测验证
        如果回测期间内实际损失超过VaR的频率接近预期（如95%置信度下约5%），说明模型较准确
        如果频率明显偏离预期，需要检查模型参数或方法

六、与风控设置的联动

    参数读取
        VaR计算方法、置信度、时间周期、历史数据窗口长度、期货价格连续合约类型等参数
        均从"风控设置"中读取（如果已配置）
        也可以在VaR测试页面直接修改（仅本次计算生效，不保存到配置）

    阈值告警
        当VaR超过风控设置中配置的阈值时，触发告警
        告警记录在"风控告警记录"中
        可在风控驾驶舱中查看告警概览

    结果联动
        VaR计算结果可以跳转到风控驾驶舱查看整体风险概览
        风控驾驶舱中可以显示VaR指标卡片（简要信息），点击跳转到VaR测试页面查看详情

七、权限与视图

    角色权限
        风控人员：可以查看所有维度的VaR，可以修改参数进行计算
        交易员/业务员：可以查看自己相关保值方案/账户的VaR，不能修改全局参数
        管理层：可以查看公司整体的VaR，关注风险趋势

    个性化设置（可选二开）
        不同角色可定义自己的常用参数配置和默认筛选条件
        支持保存个人参数模板
