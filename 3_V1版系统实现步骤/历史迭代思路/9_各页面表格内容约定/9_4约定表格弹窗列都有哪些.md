# 表格弹窗列约定

本文档定义各个表格中哪些列可以点击后弹窗查看详情，以及弹窗中显示的内容。

## 一、合同表（contract）

### 可点击弹窗的列

#### 1. 合同编号
- **触发方式**：点击合同编号列的单元格
- **弹窗标题**：合同详情
- **弹窗内容**：
  - **基本信息**
    - 保值方案：显示保值方案名称
    - 业务经理：显示业务经理姓名
    - 合同编号：显示合同编号
    - 供应商/客户：显示供应商或客户简称和全称
    - 现货品种：显示现货品种名称
    - 品牌：显示品牌名称
    - 计价方式：显示计价方式（一口价/暂定价/均价）
  - **数量与价格信息**
    - 合同数量：显示合同数量
    - 单价：显示单价
    - 结算单价：显示结算单价
    - 合同金额：显示合同金额（自动计算）
    - 结算金额：显示结算金额（自动计算）
    - 已点数量：显示已点数量
    - 未点数量：显示未点数量（合同数量 - 已点数量）
  - **时间信息**
    - 发生日期时间：显示发生日期时间
    - 均价起止日：显示均价起止日（如果适用）
    - 点价截止日：显示点价截止日
    - 交割日期：显示交割日期
    - 创建日期时间：显示创建日期时间
  - **其他信息**
    - 运输方式：显示运输方式（自提/送到）
    - 创建人：显示创建人姓名
    - 状态：显示状态（启用/禁用/已删除）
    - 备注：显示备注信息
  - **自定义字段**：显示该合同的所有自定义字段及其值
  - **关联信息**（可选显示）
    - 期现关联记录：显示关联的期货委托单信息（合约、数量、成交日期等）
    - 采销关联记录：显示关联的采购/销售合同信息

#### 2. 供应商/客户
- **触发方式**：点击供应商/客户列的单元格
- **弹窗标题**：客商详情
- **弹窗内容**：
  - **基本信息**
    - 简称：显示客商简称
    - 全称：显示客商全称
    - 客商分类：显示客商类型（供应商/客户/仓库/物流/撮合商/客商等）
  - **联系信息**
    - 联系人：显示联系人姓名
    - 手机号：显示联系人手机号
  - **状态信息**
    - 状态：显示状态（启用/禁用/已删除）
    - 备注：显示备注信息
  - **自定义字段**：显示该客商的所有自定义字段及其值

#### 3. 已销售数量/已采购数量
- **触发方式**：点击已销售数量（采购合同）或已采购数量（销售合同）列的单元格
- **弹窗标题**：采销关系（采购合同）或采购关系（销售合同）
- **弹窗内容**：
  - **合同信息**（顶部显示）
    - 合同编号：显示当前合同的合同编号
    - 供应商/客户：显示供应商或客户简称
    - 合同数量：显示当前合同的合同数量
  - **采销关联记录表格**
    - 合同编号：关联的销售合同/采购合同编号
    - 客户/供应商：关联合同的客户或供应商简称
    - 业务经理：关联合同的业务经理姓名
    - 关联数量：关联的数量
    - 关联日期：关联日期
    - 发生日期时间：发生日期时间
  - **说明**：
    - 表格支持分页显示，每页20条记录
    - 表格支持滚动查看，最大高度为500px
    - 表格为只读模式，仅用于查看关联关系

#### 4. 品牌
- **触发方式**：点击品牌列的单元格
- **弹窗标题**：品牌详情
- **弹窗内容**：
  - **基本信息**
    - 名称：显示品牌名称
    - 现货品种：显示所属现货品种名称
    - 是否主港：显示是否主港（是/否）
    - 是否平台价：显示是否平台价（是/否）
    - 升贴水：显示升贴水
    - 价格：显示价格（如果是平台价或主港）
  - **期货敞口配置**
    - 期货品种列表：显示关联的期货品种列表
      - 期货品种代码
      - 敞口系数
  - **状态信息**
    - 状态：显示状态（启用/禁用/已删除）
    - 备注：显示备注信息
  - **价格历史**（可选显示）
    - 历史价格记录：显示最近的价格变动历史（日期、价格、升贴水）
  - **自定义字段**：显示该品牌的所有自定义字段及其值

---

### 关联按钮弹出框

#### 触发方式
- **触发方式**：选择合同后，点击"关联"按钮
- **弹窗标题**：关联

#### 弹窗内容

弹窗包含两个标签页：**期现关联** 和 **采销关联**

##### 一、期现关联标签页

###### 筛选区域
支持以下筛选条件：
- **合约**：文本输入框，支持模糊匹配
- **成交日期**：日期范围选择器
- **价格**：数字输入框

###### 期货委托单表格

表格默认显示以下列（按从左到右的顺序）：

1. **选择**
   - 列宽：50px
   - 显示：复选框，用于多选

2. **账户**
   - 列宽：120px
   - 显示：期货账户名称或别名

3. **合约**
   - 列宽：100px
   - 显示：期货合约代码

4. **买卖**
   - 列宽：80px
   - 显示：买入/卖出

5. **开平**
   - 列宽：80px
   - 显示：开仓/平仓

6. **成交日期**
   - 列宽：120px
   - 显示：成交日期

7. **价格**
   - 列宽：100px
   - 显示：成交价格
   - 对齐方式：右对齐

8. **期货数量**
   - 列宽：100px
   - 显示：可编辑的数字输入框
   - 说明：用户需要输入关联的期货数量

9. **合同数量**
   - 列宽：100px
   - 显示：可编辑的数字输入框
   - 说明：用户需要输入关联的合同数量

10. **发生时间**
    - 列宽：180px
    - 显示：日期时间选择器（可选，不填默认为当前时间）

**说明**：
- 表格数据来源：显示同保值方案的期货委托，且没有指定指令编号的委托单
- 排序规则：未匹配数量大于0的委托单会靠上显示（未匹配数量大的优先）
- 表格支持自定义列：用户可以通过列配置功能显示期货委托单的所有字段
- 表格高度：支持滚动查看，可显示15-20行数据
- 弹窗大小：宽度1200px，最大高度为视口高度减去200px

##### 二、采销关联标签页

###### 筛选区域
支持以下筛选条件：
- **合同编号**：文本输入框，支持模糊匹配
- **客商**：文本输入框，支持模糊匹配
- **业务经理**：文本输入框，支持模糊匹配

###### 合同表格

表格默认显示以下列：
1. **选择**：复选框，用于多选
2. **合同编号**：合同编号
3. **客商**：客商简称
4. **数量**：可编辑的数字输入框，用户需要输入关联数量
5. **发生时间**：日期时间选择器（可选，不填默认为当前时间）

**说明**：
- 表格显示方向相反的合同（采购合同显示销售合同，销售合同显示采购合同）
- 默认筛选条件：相同的现货品种、品牌、方向，且未匹配数量大于0
- 表格支持自定义列：用户可以通过列配置功能显示合同的所有字段

---

## 二、客商表（customer）

### 可点击弹窗的列

#### 1. 简称/全称
- **触发方式**：点击简称或全称列的单元格
- **弹窗标题**：客商详情
- **弹窗内容**：
  - **基本信息**
    - 简称：显示客商简称
    - 全称：显示客商全称
    - 客商分类：显示客商类型（供应商/客户/仓库/物流/撮合商/客商等）
  - **联系信息**
    - 联系人：显示联系人姓名
    - 手机号：显示联系人手机号
  - **状态信息**
    - 状态：显示状态（启用/禁用/已删除）
    - 创建日期时间：显示创建日期时间
    - 备注：显示备注信息
  - **自定义字段**：显示该客商的所有自定义字段及其值
  - **关联信息**（可选显示）
    - 关联合同列表：显示该客商关联的合同信息（合同编号、合同数量、合同金额等）

---

## 三、现货品种表（spot_variety）

### 可点击弹窗的列

#### 1. 名称
- **触发方式**：点击名称列的单元格
- **弹窗标题**：现货品种详情
- **弹窗内容**：
  - **基本信息**
    - 名称：显示现货品种名称
  - **状态信息**
    - 状态：显示状态（启用/禁用/已删除）
    - 创建日期时间：显示创建日期时间
    - 备注：显示备注信息
  - **自定义字段**：显示该现货品种的所有自定义字段及其值
  - **关联信息**（可选显示）
    - 品牌列表：显示该现货品种下的所有品牌信息（品牌名称、是否主港、是否平台价等）

---

## 四、品牌表（spot_brand）

### 可点击弹窗的列

#### 1. 名称
- **触发方式**：点击名称列的单元格
- **弹窗标题**：品牌详情
- **弹窗内容**：
  - **基本信息**
    - 名称：显示品牌名称
    - 现货品种：显示所属现货品种名称
    - 是否主港：显示是否主港（是/否）
    - 是否平台价：显示是否平台价（是/否）
    - 升贴水：显示升贴水
    - 价格：显示价格（如果是平台价或主港）
  - **期货敞口配置**
    - 期货品种列表：显示关联的期货品种列表
      - 期货品种代码
      - 敞口系数
  - **状态信息**
    - 状态：显示状态（启用/禁用/已删除）
    - 创建日期时间：显示创建日期时间
    - 备注：显示备注信息
  - **价格历史**（可选显示）
    - 历史价格记录：显示最近的价格变动历史（日期、价格、升贴水）
  - **自定义字段**：显示该品牌的所有自定义字段及其值

---

## 五、人员表（person/user）

### 可点击弹窗的列

#### 1. 姓名
- **触发方式**：点击姓名列的单元格
- **弹窗标题**：人员详情
- **弹窗内容**：
  - **基本信息**
    - 姓名：显示人员姓名
    - 手机号：显示人员手机号
  - **角色信息**
    - 角色列表：显示该人员所属的所有角色（角色名称列表）
  - **状态信息**
    - 状态：显示状态（启用/禁用/已删除）
    - 创建日期时间：显示创建日期时间
    - 备注：显示备注信息
  - **自定义字段**：显示该人员的所有自定义字段及其值

---

## 六、角色表（role）

### 可点击弹窗的列

#### 1. 名称
- **触发方式**：点击名称列的单元格
- **弹窗标题**：角色详情
- **弹窗内容**：
  - **基本信息**
    - 名称：显示角色名称
    - 角色解释：显示角色的定义和说明
  - **人员信息**
    - 人员列表：显示该角色下的所有人员（姓名、手机号、状态）
    - 人员数量：显示关联的人员数量
  - **状态信息**
    - 状态：显示状态（启用/禁用/已删除）
    - 创建日期时间：显示创建日期时间
    - 备注：显示备注信息
  - **自定义字段**：显示该角色的所有自定义字段及其值

---

## 七、期货账户表（futures_account）

### 可点击弹窗的列

#### 1. 期货账户/别名
- **触发方式**：点击期货账户或别名列的单元格
- **弹窗标题**：期货账户详情
- **弹窗内容**：
  - **基本信息**
    - 期货账户：显示期货账户名称或编号
    - 别名：显示账户别名
    - 期货公司：显示期货公司名称
    - 前置：显示前置服务器地址
  - **人员信息**
    - 交易员列表：显示关联的交易员姓名列表
  - **状态信息**
    - 账户状态：显示账户状态（启用/禁用）
    - 创建日期时间：显示创建日期时间
    - 备注：显示备注信息
  - **自定义字段**：显示该期货账户的所有自定义字段及其值

---

## 八、保值方案表（hedge_plan）

### 可点击弹窗的列

#### 1. 名称
- **触发方式**：点击名称列的单元格
- **弹窗标题**：保值方案详情
- **弹窗内容**：
  - **基本信息**
    - 名称：显示保值方案名称
    - 类型：显示保值方案类型（整体匹配/单单匹配/无合同（人员）/无合同（客商））
  - **人员配置**
    - 交易员列表：显示交易员姓名列表
    - 制单员列表：显示制单员姓名列表
  - **业务配置**
    - 指令类型：显示指令类型列表
    - 标签列表：显示标签字符串列表
  - **状态信息**
    - 状态：显示状态（启用/禁用/已删除）
    - 创建日期时间：显示创建日期时间
    - 备注：显示备注信息
  - **自定义字段**：显示该保值方案的所有自定义字段及其值

---

## 九、期货委托单表（entrust_order）

### 可点击弹窗的列

#### 1. 指令编号/短编号
- **触发方式**：点击指令编号或短编号列的单元格
- **弹窗标题**：期货委托单详情
- **弹窗内容**：
  - **基本信息**
    - 指令编号：显示指令编号
    - 短编号：显示众期短编号
    - 保值方案：显示保值方案名称
    - 合约：显示期货合约代码
    - 方向：显示买入/卖出
    - 开平：显示开仓/平仓
  - **成交信息**
    - 成交日期：显示成交日期
    - 成交价格：显示成交价格
    - 成交手数：显示成交手数
    - 成交均价：显示成交均价
    - 未成交手数：显示未成交手数
  - **匹配信息**
    - 已匹配手数：显示已匹配手数
    - 未匹配手数：显示未匹配手数（成交手数 - 已匹配手数）
    - 是否已匹配：显示是/否
  - **交易所信息**
    - 报单编号：显示交易所报单编号
    - 挂单状态：显示挂单状态
    - 详细状态：显示详细状态
    - 投保：显示投保类型
    - 交易所：显示交易所名称
    - 报单时间：显示报单时间
    - 最后成交时间：显示最后成交时间
  - **其他信息**
    - 委托备注：显示委托备注（支持富文本）
    - 状态：显示状态（启用/禁用/已删除）
    - 创建日期时间：显示创建日期时间
    - 备注：显示备注信息
  - **自定义字段**：显示该委托单的所有自定义字段及其值
  - **关联信息**（可选显示）
    - 期现备注列表：显示关联的期现备注信息（标签、客商、合同、手数等）

---

## 十、期现备注表（spot_futures_remark）

### 可点击弹窗的列

#### 1. 委托单短编号
- **触发方式**：点击委托单短编号列的单元格
- **弹窗标题**：期现备注详情
- **弹窗内容**：
  - **基本信息**
    - 委托单短编号：显示关联的委托单短编号
    - 标签：显示标签名称
    - 客商：显示客商简称（如果已选择客商）
    - 合同编号：显示合同编号（如果已选择合同）
  - **数量与价格信息**
    - 手数：显示期现备注手数
    - 现货数量：显示现货数量
    - 点价价格：显示点价价格
  - **匹配信息**
    - 是否已匹配：显示是/否
  - **其他信息**
    - 创建日期时间：显示创建日期时间
    - 备注：显示备注信息
  - **自定义字段**：显示该期现备注的所有自定义字段及其值

---

## 十一、通用规则

### 1. 弹窗显示规则
- 所有弹窗内容以只读形式显示，不允许在弹窗中直接编辑
- 弹窗中显示的信息应该是该实体的完整信息，包括所有标准字段和自定义字段
- 对于关联字段（如_id字段），应该显示关联实体的名称而不是ID
- 对于列表字段（如json_list类型），应该以友好的方式展示（如用逗号分隔、标签形式等）

### 2. 弹窗交互规则
- 弹窗应该有明确的关闭按钮
- 弹窗大小应该适中，能够完整显示内容，支持滚动查看
- 如果内容较多，可以使用标签页（Tabs）分组显示
- 弹窗中的关联信息可以支持进一步点击跳转（如点击合同编号跳转到合同详情）
- 对于包含表格的弹窗（如关联按钮弹出框），表格支持自定义列功能，用户可以根据需要显示所有可用字段

### 3. 性能优化
- 弹窗内容应该按需加载，避免一次性加载过多数据
- 对于关联信息（如期现关联记录），可以考虑延迟加载或分页显示
- 弹窗打开时应该有加载状态提示

### 4. 权限控制
- 弹窗中显示的内容应该遵循用户的权限设置
- 如果用户没有查看某些字段的权限，应该在弹窗中隐藏或标记为"无权限查看"

### 5. 自定义字段显示
- 所有支持自定义字段的实体，在弹窗中都应该显示自定义字段
- 自定义字段应该按照字段定义中的排序顺序显示
- 如果自定义字段值为空，可以显示为"-"或"未填写"

---

## 十二、后续扩展

如果后续版本中新增表格或修改表格结构，需要同步更新本文档，明确哪些列支持弹窗查看详情。

